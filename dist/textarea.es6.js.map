{"version":3,"file":"textarea.es6.js","sources":["../src/Textarea/InputWrapper.tsx","../src/Textarea/InputTab.tsx","../src/FormattedText.tsx","../src/Textarea/PreviewTab.tsx","../src/Textarea/index.tsx"],"sourcesContent":["import * as React from 'react';\n\nexport interface WrapperProps {\n  style?: { [propName: string]: string };\n  children: React.ReactNode;\n}\n\nconst wrapper = ({ children, style = {} }: WrapperProps) => (\n  <div\n    style={{\n      border: '1px solid #ddd',\n      borderTop: '0px',\n      borderRadius: '5px',\n      borderTopLeftRadius: '0px',\n      borderTopRightRadius: '0px',\n      padding: '10px',\n      backgroundColor: '#fff',\n      textAlign: 'left',\n      ...style,\n    }}\n  >\n    {children}\n  </div>\n);\n\nexport default React.memo(wrapper);\n","import * as React from 'react';\nimport { Input, InputProps } from 'reactstrap';\nimport InputWrapper from './InputWrapper';\n\nexport interface InputMdProps extends InputProps {\n  allowFilteredHtml: boolean | undefined;\n}\n\nconst InputTabMD = (props: InputMdProps) => {\n  const { allowFilteredHtml, ...other } = props;\n\n  return (\n    <InputWrapper>\n      {allowFilteredHtml && (\n        <p>\n          You can input markdown or html (start with &lt; to indicate html) for\n          styling the text.\n        </p>\n      )}\n      <Input type=\"textarea\" {...other} />\n    </InputWrapper>\n  );\n};\n\nexport default React.memo(InputTabMD);\n","import * as React from 'react';\nimport { default as ReactMarkdown } from 'react-markdown';\nimport { filterXSS as xss, getDefaultWhiteList } from 'xss';\n\nexport interface FilterInput {\n  value: string;\n  whiteList?: { [propName: string]: string[] };\n}\n\nexport interface Props extends FilterInput {\n  allowFilteredHtml?: boolean;\n}\n\nexport default class FormattedText extends React.PureComponent<Props> {\n  static filterXss({\n    value,\n    whiteList = {\n      source: ['src', 'type'],\n      img: ['src', 'alt', 'title', 'width', 'height', 'style'],\n      video: [\n        'autoplay',\n        'controls',\n        'loop',\n        'preload',\n        'src',\n        'height',\n        'width',\n        'style',\n      ],\n    },\n  }: FilterInput): string {\n    const options = {\n      whiteList: {\n        ...getDefaultWhiteList(),\n        ...whiteList,\n      },\n      stripIgnoreTagBody: ['script'], // the script tag is a special case, we need\n      // to filter out its content\n    };\n    return xss(value, options);\n  }\n\n  render() {\n    const { value, allowFilteredHtml = false, whiteList } = this.props;\n\n    if (typeof value !== 'string') return null;\n\n    if (allowFilteredHtml && value.indexOf('<') === 0) {\n      const filteredContent = FormattedText.filterXss({ value, whiteList });\n      return <div dangerouslySetInnerHTML={{ __html: filteredContent }} />;\n    }\n\n    return <ReactMarkdown source={value} escapeHtml={false} />;\n  }\n}\n","import * as React from 'react';\nimport InputWrapper from './InputWrapper';\nimport { default as FormattedText } from '../FormattedText';\nimport { InputProps } from 'reactstrap';\n\nexport interface PreviewProps extends Pick<InputProps, 'value'> {\n  allowFilteredHtml: boolean | undefined;\n  skipRender: boolean;\n}\n\nconst PreviewTabMD = (props: PreviewProps) => {\n  const { allowFilteredHtml, value } = props;\n  if (typeof value !== 'string') {\n    return <InputWrapper>-</InputWrapper>;\n  }\n\n  return (\n    <InputWrapper>\n      <FormattedText value={value} allowFilteredHtml={allowFilteredHtml} />\n    </InputWrapper>\n  );\n};\n\nexport default React.memo(\n  PreviewTabMD,\n  (prevProps: PreviewProps, newProps: PreviewProps) => {\n    if (newProps.skipRender) return false;\n\n    const { value, allowFilteredHtml } = prevProps;\n    if (\n      newProps.value !== value ||\n      newProps.allowFilteredHtml !== allowFilteredHtml\n    ) {\n      return true;\n    }\n\n    return false;\n  }\n);\n","import * as React from 'react';\nimport {\n  Nav,\n  NavItem,\n  NavLink,\n  TabContent,\n  TabPane,\n  InputProps,\n} from 'reactstrap';\nimport InputTab from './InputTab';\nimport PreviewTab from './PreviewTab';\nimport { default as FormattedText } from '../FormattedText';\n\nexport interface State {\n  showEdit: boolean;\n}\n\nexport interface TextareaProps extends InputProps {\n  allowFilteredHtml?: boolean;\n  toggle?: boolean;\n  whiteList?: { [propName: string]: string[] };\n  filteredValue?: React.MutableRefObject<string | undefined>;\n}\n\nconst MdTextarea = (props: TextareaProps) => {\n  const {\n    id = 'unknown_markdown_id',\n    value,\n    toggle,\n    allowFilteredHtml = false,\n    rows,\n    cols,\n    onChange,\n    onFocus,\n    onBlur,\n    valid,\n    invalid,\n    bsSize,\n    name,\n    autoFocus,\n    disabled,\n    maxLength,\n    readOnly,\n    required,\n    wrap,\n    whiteList,\n    filteredValue,\n  } = props;\n  const [showEdit, setShowEdit] = React.useState(true);\n  const onEditClick = React.useCallback(() => {\n    if (toggle) {\n      setShowEdit(!showEdit);\n    } else {\n      setShowEdit(true);\n    }\n  }, [showEdit]);\n  const onPreviewClick = React.useCallback(() => {\n    if (toggle) {\n      setShowEdit(!showEdit);\n    } else {\n      setShowEdit(false);\n    }\n  }, [showEdit]);\n\n  React.useEffect(() => {\n    if (!filteredValue) {\n      return;\n    }\n\n    if (typeof value !== 'string') {\n      filteredValue.current = undefined;\n      return;\n    }\n\n    filteredValue.current = FormattedText.filterXss({ value, whiteList });\n  }, [value, whiteList]);\n\n  return (\n    <>\n      <Nav tabs={true} key=\"Nav\">\n        <NavItem>\n          <NavLink active={showEdit} onClick={onEditClick}>\n            Edit\n          </NavLink>\n        </NavItem>\n        <NavItem>\n          <NavLink active={!showEdit} onClick={onPreviewClick}>\n            Preview\n          </NavLink>\n        </NavItem>\n      </Nav>\n      <TabContent\n        key=\"Content\"\n        id={`tabpane_${id}`}\n        activeTab={showEdit ? 'Edit' : 'Preview'}\n      >\n        <TabPane tabId=\"Edit\">\n          <InputTab\n            allowFilteredHtml={allowFilteredHtml}\n            value={value}\n            rows={rows}\n            cols={cols}\n            {...{ onChange, onFocus, onBlur }}\n            {...{ valid, name, invalid, bsSize }}\n            {...{ autoFocus, disabled, maxLength, readOnly, required, wrap }}\n          />\n        </TabPane>\n        <TabPane tabId=\"Preview\">\n          <PreviewTab\n            allowFilteredHtml={allowFilteredHtml}\n            value={value}\n            skipRender={!showEdit}\n          />\n        </TabPane>\n      </TabContent>\n    </>\n  );\n};\n\nexport default React.memo(MdTextarea);\n"],"names":["React.createElement","React.memo","xss","React.PureComponent","React.useCallback","React.useEffect"],"mappings":"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"}